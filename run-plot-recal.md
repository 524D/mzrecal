# Plotting recalibration results

This describes how to install the software needed to create plots using the R script `plot-recal.R` script, and how to run this script.
This script can only be used with search results of [Comet](https://uwpr.github.io/Comet/).

Note: `plot-recal.R` is purely used for visualisation and thus not an "official" part of mzRecal. We can offer no support in using
this script. The procedure described here was tested with R version 4.1.0 and BioConductor version 3.14.

## Installation

Note: installation must be executed with root (Linux)/ Administrator (Windows) privileges.

* Install R from https://cran.r-project.org/ 
* Start R:
    ```
    cd "\Program Files\R\R-4.1.0"
    R
    ```
* Install standard R packages, install BioConductor and install MSnbase. From the R command prompt:
    ```R
    install.packages(c("stringr", "futile.logger", "optparse", "ggplot2", "gridExtra"))
    if (!requireNamespace("BiocManager", quietly = TRUE))
        install.packages("BiocManager")
    BiocManager::install(version = "3.14")
    if (!requireNamespace("BiocManager", quietly = TRUE))
        install.packages("BiocManager")
    BiocManager::install("MSnbase")
    ```

## Execution

After the above software is installed, plots can be generated by running from the command prompt:

```
Rscript plot-recal.R -e 0.01 -m 10 --outfile=recalplot --name="Plot of mRecal results" orig.mzid recalibrated.mzid
```

Where option `-e` is the cutoff value for the Comet expect score and option `-m` is the maximum ppm error included in the plot, and the final arguments are the mzID file of the original and recalibrated data.

